{% extends 'core/base.html' %}
{% block title %}Dashboard{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
  <h2>Selamat Datang, Admin</h2>
  <h5 id="realtime-clock" class="text-muted"></h5>
</div>

<div class="row">
  <div class="col-md-3 mb-3">
    <div class="card text-white bg-primary shadow-sm">
      <div class="card-body text-center">
        <i class="fas fa-box fa-2x mb-2"></i>
        <h5 class="card-title">Total Barang</h5>
        <p class="display-6">{{ total_barang }}</p>
      </div>
    </div>
  </div>
  <div class="col-md-3 mb-3">
    <div class="card text-white bg-success shadow-sm">
      <div class="card-body text-center">
        <i class="fas fa-truck fa-2x mb-2"></i>
        <h5 class="card-title">Total Vendor</h5>
        <p class="display-6">{{ total_vendor }}</p>
      </div>
    </div>
  </div>
  <div class="col-md-3 mb-3">
    <div class="card text-white bg-warning shadow-sm">
      <div class="card-body text-center">
        <i class="fas fa-user-friends fa-2x mb-2"></i>
        <h5 class="card-title">Total Pelanggan</h5>
        <p class="display-6">{{ total_pembeli }}</p>
      </div>
    </div>
  </div>
  <div class="col-md-3 mb-3">
    <div class="card text-white bg-danger shadow-sm">
      <div class="card-body text-center">
        <i class="fas fa-file-invoice-dollar fa-2x mb-2"></i>
        <h5 class="card-title">Total Faktur</h5>
        <p class="display-6">{{ total_faktur }}</p>
      </div>
    </div>
  </div>
</div>

<div class="row mt-4">
  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-header bg-light fw-bold">
        <i class="fas fa-map-marker-alt me-1"></i> Kelurahan Paling Banyak Diantar
      </div>
      <ul class="list-group list-group-flush">
        {% for k in kelurahan_terbanyak %}
          <li class="list-group-item d-flex justify-content-between">
            {{ k.pembeli__kelurahan__nama_kelurahan }} <span>{{ k.jumlah }}x</span>
          </li>
        {% empty %}
          <li class="list-group-item">Belum ada data</li>
        {% endfor %}
      </ul>
    </div>
  </div>

  <div class="col-md-6">
    <div class="card shadow-sm">
      <div class="card-header bg-light fw-bold">
        <i class="fas fa-users me-1"></i> Pelanggan Loyal
      </div>
      <ul class="list-group list-group-flush">
        {% for p in pelanggan_loyal %}
          <li class="list-group-item d-flex justify-content-between">
            {{ p.pembeli__nama }} <span>{{ p.jumlah }} faktur</span>
          </li>
        {% empty %}
          <li class="list-group-item">Belum ada data</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</div>

<!-- Realtime Clock Script -->
<script>
  function updateClock() {
    const now = new Date();
    const timeString = now.toLocaleTimeString('id-ID');
    document.getElementById('realtime-clock').textContent = timeString;
  }
  setInterval(updateClock, 1000);
  updateClock();
</script>

{% endblock %}
